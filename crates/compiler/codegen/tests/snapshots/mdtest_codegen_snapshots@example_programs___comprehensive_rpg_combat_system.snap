---
source: crates/compiler/codegen/tests/mdtest_snapshots.rs
description: "Codegen snapshot for mdtest: Example Programs - Comprehensive RPG Combat System"
input_file: mdtest/07-example-programs/example-00.md
---
Source:
// Struct definitions showing custom types
struct Character {
    health: u32,
    mana: u32,
    level: u32,
    position: Position,
}

struct Position {
    x: u32,
    y: u32,
}

struct CombatResult {
    damage_dealt: u32,
    critical_hit: bool,
    remaining_health: u32,
}


// Entry point demonstrating tuple usage and multiple features
fn main_test() -> u32 {
    let battle_result = simulate_full_battle();

    // Create a summary tuple
    let summary = get_character_stats(Character {
        health: 100,
        mana: 50,
        level: 5,
        position: Position { x: 0, y: 0 },
    });

    // Extract tuple values
    let (health, mana, level) = summary;

    // Combine results using both felt and u32 arithmetic
    let final_score: u32 = battle_result + level;  // u32 + u32 in felt context
    let bonus_score = mana / 10u32;  // felt arithmetic

    return final_score + bonus_score;
}


// Function demonstrating tuples as return types
fn get_character_stats(char: Character) -> (u32, u32, u32) {
    return (char.health, char.mana, char.level);
}

// Function with complex struct manipulation and arithmetic
fn calculate_distance_squared(pos1: Position, pos2: Position) -> u32 {
    let dx: u32 = 0;
    if (pos1.x >= pos2.x) {
        dx = pos1.x - pos2.x;
    } else {
        dx = pos2.x - pos1.x;
    }
    let dy: u32 = 0;
    if (pos1.y >= pos2.y) {
        dy = pos1.y - pos2.y;
    } else {
        dy = pos2.y - pos1.y;
    }
    return dx * dx + dy * dy;
}

// Function demonstrating control flow and u32/felt operations
fn calculate_damage(attacker_level: u32, defender_level: u32, distance: u32) -> u32 {
    let base_damage: u32 = 10;
    let level_bonus = attacker_level * 2;

    // Convert felt to rough u32 for distance penalty (simplified)
    let distance_penalty: u32 = 0;
    if (distance > 100) {
        distance_penalty = 5;
    } else {
        if (distance > 50) {
            distance_penalty = 2;
        }
    }

    let total_damage = base_damage + level_bonus;
    if (total_damage > distance_penalty) {
        return total_damage - distance_penalty;
    } else {
        return 1;  // Minimum damage
    }
}

// Function showing loops and complex logic
fn perform_combat(attacker: Character, defender: Character) -> CombatResult {
    let distance = calculate_distance_squared(attacker.position, defender.position);
    let base_damage = calculate_damage(attacker.level, defender.level, distance);

    // Critical hit calculation using felt arithmetic
    let critical_multiplier = attacker.mana / 10u32;  // u32 division
    let is_critical: bool = false;
    let final_damage = base_damage;

    if (critical_multiplier > 5) {
        is_critical = true;
        final_damage = base_damage * 2;
    }

    // Apply damage with bounds checking
    let new_health = defender.health;
    if (final_damage >= defender.health) {
        new_health = 0;
    } else {
        new_health = defender.health - final_damage;
    }

    let res = CombatResult {
        damage_dealt: final_damage,
        critical_hit: is_critical,
        remaining_health: new_health,
    };
    return res;
}

// Function demonstrating multiple function calls and tuple destructuring
fn simulate_battle_round(hero: Character, enemy: Character) -> u32 {
    // Hero attacks enemy
    let hero_attack = perform_combat(hero, enemy);
    let enemy_health = hero_attack.remaining_health;

    // Enemy counter-attacks if still alive
    if (enemy_health > 0) {
        let enemy_counter = perform_combat(enemy, hero);
        let hero_health = enemy_counter.remaining_health;

        // Return 1 if hero wins, 2 if enemy wins, 0 if both alive
        if (enemy_health == 0) {
            return 1;  // Hero wins
        } else {
            if (hero_health == 0) {
                return 2;  // Enemy wins
            } else {
                return 0;  // Both alive, continue battle
            }
        }
    } else {
        return 1;  // Hero wins immediately
    }
}

// Main function demonstrating variable mutation and comprehensive example
fn simulate_full_battle() -> u32 {
    // Create characters using struct literals
    let hero = Character {
        health: 100,
        mana: 50,
        level: 5,
        position: Position { x: 10, y: 20 },
    };

    let enemy = Character {
        health: 80,
        mana: 30,
        level: 4,
        position: Position { x: 15, y: 25 },
    };

    // Battle loop with mutation
    let current_hero = hero;
    let current_enemy = enemy;
    let round: u32 = 1;
    let max_rounds: u32 = 10;

    // Simulate multiple battle rounds
    loop {
        if (round > max_rounds) {
            break;  // Draw after max rounds
        }

        let result = simulate_battle_round(current_hero, current_enemy);

        if (result == 1) {
            return 1;  // Hero victory
        } else {
            if (result == 2) {
                return 2;  // Enemy victory
            }
        }

        // Update for next round (simplified - reduce both healths)
        if (current_hero.health > 10) {
            current_hero.health = current_hero.health - 5;
        }
        if (current_enemy.health > 8) {
            current_enemy.health = current_enemy.health - 4;
        }

        round = round + 1;
    }

    return 0;  // Draw
}
============================================================
Generated CASM:
main_test:
main_test:
main_test_0:
   0: 10 30 230 _          // call simulate_full_battle
   1: 23 0 0 2             // [fp + 2], [fp + 3] = u32(0)
   2: 23 0 0 4             // [fp + 4], [fp + 5] = u32(0)
   3: 23 100 0 6           // [fp + 6], [fp + 7] = u32(100)
   4: 23 50 0 8            // [fp + 8], [fp + 9] = u32(50)
   5: 23 5 0 10            // [fp + 10], [fp + 11] = u32(5)
   6: 4 2 0 12             // [fp + 12] = [fp + 2] + 0
   7: 4 3 0 13             // [fp + 13] = [fp + 3] + 0
   8: 4 4 0 14             // [fp + 14] = [fp + 4] + 0
   9: 4 5 0 15             // [fp + 15] = [fp + 5] + 0
  10: 4 6 0 32             // Arg 0 slot 0: [fp + 32] = [fp + 6] + 0
  11: 4 7 0 33             // Arg 0 slot 1: [fp + 33] = [fp + 7] + 0
  12: 4 8 0 34             // Arg 0 slot 2: [fp + 34] = [fp + 8] + 0
  13: 4 9 0 35             // Arg 0 slot 3: [fp + 35] = [fp + 9] + 0
  14: 4 10 0 36            // Arg 0 slot 4: [fp + 36] = [fp + 10] + 0
  15: 4 11 0 37            // Arg 0 slot 5: [fp + 37] = [fp + 11] + 0
  16: 4 12 0 38            // Arg 0 slot 6: [fp + 38] = [fp + 12] + 0
  17: 4 13 0 39            // Arg 0 slot 7: [fp + 39] = [fp + 13] + 0
  18: 4 14 0 40            // Arg 0 slot 8: [fp + 40] = [fp + 14] + 0
  19: 4 15 0 41            // Arg 0 slot 9: [fp + 41] = [fp + 15] + 0
  20: 10 48 28 _           // call get_character_stats
  21: 15 28 46 22          // u32([fp + 22], [fp + 23]) = u32([fp + 28], [fp + 29]) U32Add u32([fp + 46], [fp + 47])
  22: 22 44 10 0 24        // u32([fp + 24], [fp + 25]) = u32([fp + 44], [fp + 45]) U32Div u32(10, 0)
  23: 15 22 24 26          // u32([fp + 26], [fp + 27]) = u32([fp + 22], [fp + 23]) U32Add u32([fp + 24], [fp + 25])
  24: 4 26 0 -4            // Return value 0 slot 0: [fp -4] = [fp + 26] + 0
  25: 4 27 0 -3            // Return value 0 slot 1: [fp -3] = [fp + 27] + 0
  26: 11 _ _ _             // return
get_character_stats:
get_character_stats_0:
  27: 4 -18 0 -8           // Return value 0 slot 0: [fp -8] = [fp + -18] + 0
get_character_stats:
  28: 4 -17 0 -7           // Return value 0 slot 1: [fp -7] = [fp + -17] + 0
  29: 4 -16 0 -6           // Return value 1 slot 0: [fp -6] = [fp + -16] + 0
  30: 4 -15 0 -5           // Return value 1 slot 1: [fp -5] = [fp + -15] + 0
  31: 4 -14 0 -4           // Return value 2 slot 0: [fp -4] = [fp + -14] + 0
  32: 4 -13 0 -3           // Return value 2 slot 1: [fp -3] = [fp + -13] + 0
  33: 11 _ _ _             // return
calculate_distance_squared:
calculate_distance_squared_0:
  34: 23 0 0 0             // u32([fp + 0], [fp + 1]) = u32(0)
calculate_distance_squared:
  35: 28 -12 -8 6          // [fp + 6] = u32([fp + -12], [fp + -11]) U32GreaterEqual u32([fp + -8], [fp + -7])
  36: 9 1 48 _             // [fp + 48] = 1
  37: 4 6 0 54             // [fp + 54] = [fp + 6] + 0
  38: 1 48 54 6            // [fp + 6] = [fp + 48] op [fp + 54]
  39: 14 6 2 _             // if [fp + 6] != 0 jmp rel calculate_distance_squared_1
  40: 12 46 _ _            // jump abs calculate_distance_squared_2
calculate_distance_squared_1:
  41: 16 -12 -8 11         // u32([fp + 11], [fp + 12]) = u32([fp + -12], [fp + -11]) U32Sub u32([fp + -8], [fp + -7])
  42: 19 11 0 0 13         // u32([fp + 13], [fp + 14]) = u32([fp + 11], [fp + 12]) + u32(0, 0)
  43: 12 49 _ _            // jump abs calculate_distance_squared_3
calculate_distance_squared_2:
  44: 16 -8 -12 19         // u32([fp + 19], [fp + 20]) = u32([fp + -8], [fp + -7]) U32Sub u32([fp + -12], [fp + -11])
  45: 19 19 0 0 13         // u32([fp + 13], [fp + 14]) = u32([fp + 19], [fp + 20]) + u32(0, 0)
calculate_distance_squared_3:
  46: 23 0 0 21            // u32([fp + 21], [fp + 22]) = u32(0)
  47: 28 -10 -6 27         // [fp + 27] = u32([fp + -10], [fp + -9]) U32GreaterEqual u32([fp + -6], [fp + -5])
  48: 9 1 49 _             // [fp + 49] = 1
  49: 4 27 0 54            // [fp + 54] = [fp + 27] + 0
  50: 1 49 54 27           // [fp + 27] = [fp + 49] op [fp + 54]
  51: 14 27 2 _            // if [fp + 27] != 0 jmp rel calculate_distance_squared_4
  52: 12 60 _ _            // jump abs calculate_distance_squared_5
calculate_distance_squared_4:
  53: 16 -10 -6 32         // u32([fp + 32], [fp + 33]) = u32([fp + -10], [fp + -9]) U32Sub u32([fp + -6], [fp + -5])
  54: 19 32 0 0 34         // u32([fp + 34], [fp + 35]) = u32([fp + 32], [fp + 33]) + u32(0, 0)
  55: 12 63 _ _            // jump abs calculate_distance_squared_6
calculate_distance_squared_5:
  56: 16 -6 -10 40         // u32([fp + 40], [fp + 41]) = u32([fp + -6], [fp + -5]) U32Sub u32([fp + -10], [fp + -9])
  57: 19 40 0 0 34         // u32([fp + 34], [fp + 35]) = u32([fp + 40], [fp + 41]) + u32(0, 0)
calculate_distance_squared_6:
  58: 17 13 13 42          // u32([fp + 42], [fp + 43]) = u32([fp + 13], [fp + 14]) U32Mul u32([fp + 13], [fp + 14])
  59: 17 34 34 44          // u32([fp + 44], [fp + 45]) = u32([fp + 34], [fp + 35]) U32Mul u32([fp + 34], [fp + 35])
  60: 15 42 44 46          // u32([fp + 46], [fp + 47]) = u32([fp + 42], [fp + 43]) U32Add u32([fp + 44], [fp + 45])
  61: 4 46 0 -4            // Return value 0 slot 0: [fp -4] = [fp + 46] + 0
  62: 4 47 0 -3            // Return value 0 slot 1: [fp -3] = [fp + 47] + 0
  63: 11 _ _ _             // return
calculate_damage:
calculate_damage_0:
  64: 23 10 0 0            // u32([fp + 0], [fp + 1]) = u32(10)
  65: 21 -10 2 0 2         // u32([fp + 2], [fp + 3]) = u32([fp + -10], [fp + -9]) U32Mul u32(2, 0)
  66: 23 0 0 4             // u32([fp + 4], [fp + 5]) = u32(0)
  67: 34 -6 101 0 6        // [fp + 6] = u32([fp + -6], [fp + -5]) U32Greater u32(101, 0)
  68: 9 1 21 _             // [fp + 21] = 1
calculate_damage:
  69: 4 6 0 25             // [fp + 25] = [fp + 6] + 0
  70: 1 21 25 6            // [fp + 6] = [fp + 21] op [fp + 25]
  71: 14 6 2 _             // if [fp + 6] != 0 jmp rel calculate_damage_1
  72: 12 84 _ _            // jump abs calculate_damage_2
calculate_damage_1:
  73: 23 5 0 7             // u32([fp + 7], [fp + 8]) = u32(5)
  74: 19 7 0 0 9           // u32([fp + 9], [fp + 10]) = u32([fp + 7], [fp + 8]) + u32(0, 0)
  75: 12 98 _ _            // jump abs calculate_damage_5
calculate_damage_2:
  76: 34 -6 51 0 11        // [fp + 11] = u32([fp + -6], [fp + -5]) U32Greater u32(51, 0)
  77: 9 1 22 _             // [fp + 22] = 1
  78: 4 11 0 25            // [fp + 25] = [fp + 11] + 0
  79: 1 22 25 11           // [fp + 11] = [fp + 22] op [fp + 25]
  80: 19 4 0 0 12          // u32([fp + 12], [fp + 13]) = u32([fp + 4], [fp + 5]) + u32(0, 0)
  81: 14 11 2 _            // if [fp + 11] != 0 jmp rel calculate_damage_3
  82: 12 108 _ _           // jump abs calculate_damage_8
calculate_damage_3:
  83: 23 2 0 14            // u32([fp + 14], [fp + 15]) = u32(2)
  84: 19 14 0 0 12         // u32([fp + 12], [fp + 13]) = u32([fp + 14], [fp + 15]) + u32(0, 0)
calculate_damage_4:
  85: 19 12 0 0 9          // u32([fp + 9], [fp + 10]) = u32([fp + 12], [fp + 13]) + u32(0, 0)
calculate_damage_5:
  86: 15 0 2 16            // u32([fp + 16], [fp + 17]) = u32([fp + 0], [fp + 1]) U32Add u32([fp + 2], [fp + 3])
  87: 28 9 16 18           // [fp + 18] = u32([fp + 9], [fp + 10]) U32Greater u32([fp + 16], [fp + 17])
  88: 14 18 2 _            // if [fp + 18] != 0 jmp rel calculate_damage_6
  89: 12 106 _ _           // jump abs calculate_damage_7
calculate_damage_6:
  90: 16 16 9 19           // u32([fp + 19], [fp + 20]) = u32([fp + 16], [fp + 17]) U32Sub u32([fp + 9], [fp + 10])
  91: 4 19 0 -4            // Return value 0 slot 0: [fp -4] = [fp + 19] + 0
  92: 4 20 0 -3            // Return value 0 slot 1: [fp -3] = [fp + 20] + 0
  93: 11 _ _ _             // return
calculate_damage_7:
  94: 23 1 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(1)
  95: 11 _ _ _             // return
calculate_damage_8:
  96: 12 96 _ _            // jump abs calculate_damage_4
perform_combat:
perform_combat_0:
  97: 4 -21 0 44           // Arg 0 slot 0: [fp + 44] = [fp + -21] + 0
  98: 4 -20 0 45           // Arg 0 slot 1: [fp + 45] = [fp + -20] + 0
  99: 4 -19 0 46           // Arg 0 slot 2: [fp + 46] = [fp + -19] + 0
 100: 4 -18 0 47           // Arg 0 slot 3: [fp + 47] = [fp + -18] + 0
 101: 4 -11 0 48           // Arg 1 slot 0: [fp + 48] = [fp + -11] + 0
 102: 4 -10 0 49           // Arg 1 slot 1: [fp + 49] = [fp + -10] + 0
 103: 4 -9 0 50            // Arg 1 slot 2: [fp + 50] = [fp + -9] + 0
 104: 4 -8 0 51            // Arg 1 slot 3: [fp + 51] = [fp + -8] + 0
 105: 10 54 35 _           // call calculate_distance_squared
 106: 4 -23 0 56           // Arg 0 slot 0: [fp + 56] = [fp + -23] + 0
 107: 4 -22 0 57           // Arg 0 slot 1: [fp + 57] = [fp + -22] + 0
 108: 4 -13 0 58           // Arg 1 slot 0: [fp + 58] = [fp + -13] + 0
perform_combat:
 109: 4 -12 0 59           // Arg 1 slot 1: [fp + 59] = [fp + -12] + 0
 110: 4 52 0 60            // Arg 2 slot 0: [fp + 60] = [fp + 52] + 0
 111: 4 53 0 61            // Arg 2 slot 1: [fp + 61] = [fp + 53] + 0
 112: 10 64 69 _           // call calculate_damage
 113: 22 -25 10 0 18       // u32([fp + 18], [fp + 19]) = u32([fp + -25], [fp + -24]) U32Div u32(10, 0)
 114: 9 0 20 _             // [fp + 20] = false
 115: 34 18 6 0 21         // [fp + 21] = u32([fp + 18], [fp + 19]) U32Greater u32(6, 0)
 116: 9 1 66 _             // [fp + 66] = 1
 117: 4 21 0 71            // [fp + 71] = [fp + 21] + 0
 118: 1 66 71 21           // [fp + 21] = [fp + 66] op [fp + 71]
 119: 19 62 0 0 22         // u32([fp + 22], [fp + 23]) = u32([fp + 62], [fp + 63]) + u32(0, 0)
 120: 4 20 0 24            // [fp + 24] = [fp + 20] + 0
 121: 14 21 2 _            // if [fp + 21] != 0 jmp rel perform_combat_1
 122: 12 168 _ _           // jump abs perform_combat_6
perform_combat_1:
 123: 9 1 25 _             // [fp + 25] = true
 124: 21 62 2 0 26         // u32([fp + 26], [fp + 27]) = u32([fp + 62], [fp + 63]) U32Mul u32(2, 0)
 125: 19 26 0 0 22         // u32([fp + 22], [fp + 23]) = u32([fp + 26], [fp + 27]) + u32(0, 0)
 126: 4 25 0 24            // [fp + 24] = [fp + 25] + 0
perform_combat_2:
 127: 28 22 -17 30         // [fp + 30] = u32([fp + 22], [fp + 23]) U32GreaterEqual u32([fp + -17], [fp + -16])
 128: 9 1 67 _             // [fp + 67] = 1
 129: 4 30 0 71            // [fp + 71] = [fp + 30] + 0
 130: 1 67 71 30           // [fp + 30] = [fp + 67] op [fp + 71]
 131: 14 30 2 _            // if [fp + 30] != 0 jmp rel perform_combat_3
 132: 12 154 _ _           // jump abs perform_combat_4
perform_combat_3:
 133: 23 0 0 31            // u32([fp + 31], [fp + 32]) = u32(0)
 134: 19 31 0 0 33         // u32([fp + 33], [fp + 34]) = u32([fp + 31], [fp + 32]) + u32(0, 0)
 135: 12 157 _ _           // jump abs perform_combat_5
perform_combat_4:
 136: 16 -17 22 37         // u32([fp + 37], [fp + 38]) = u32([fp + -17], [fp + -16]) U32Sub u32([fp + 22], [fp + 23])
 137: 19 37 0 0 33         // u32([fp + 33], [fp + 34]) = u32([fp + 37], [fp + 38]) + u32(0, 0)
perform_combat_5:
 138: 4 22 0 39            // [fp + 39] = [fp + 22] + 0
 139: 4 23 0 40            // [fp + 40] = [fp + 23] + 0
 140: 4 24 0 41            // [fp + 41] = [fp + 24] + 0
 141: 4 33 0 42            // [fp + 42] = [fp + 33] + 0
 142: 4 34 0 43            // [fp + 43] = [fp + 34] + 0
 143: 4 39 0 -7            // Return value 0 slot 0: [fp -7] = [fp + 39] + 0
 144: 4 40 0 -6            // Return value 0 slot 1: [fp -6] = [fp + 40] + 0
 145: 4 41 0 -5            // Return value 0 slot 2: [fp -5] = [fp + 41] + 0
 146: 4 42 0 -4            // Return value 0 slot 3: [fp -4] = [fp + 42] + 0
 147: 4 43 0 -3            // Return value 0 slot 4: [fp -3] = [fp + 43] + 0
 148: 11 _ _ _             // return
perform_combat_6:
 149: 12 144 _ _           // jump abs perform_combat_2
simulate_battle_round:
simulate_battle_round_0:
 150: 4 -24 0 15           // Arg 0 slot 0: [fp + 15] = [fp + -24] + 0
 151: 4 -23 0 16           // Arg 0 slot 1: [fp + 16] = [fp + -23] + 0
 152: 4 -22 0 17           // Arg 0 slot 2: [fp + 17] = [fp + -22] + 0
 153: 4 -21 0 18           // Arg 0 slot 3: [fp + 18] = [fp + -21] + 0
 154: 4 -20 0 19           // Arg 0 slot 4: [fp + 19] = [fp + -20] + 0
 155: 4 -19 0 20           // Arg 0 slot 5: [fp + 20] = [fp + -19] + 0
 156: 4 -18 0 21           // Arg 0 slot 6: [fp + 21] = [fp + -18] + 0
 157: 4 -17 0 22           // Arg 0 slot 7: [fp + 22] = [fp + -17] + 0
 158: 4 -16 0 23           // Arg 0 slot 8: [fp + 23] = [fp + -16] + 0
 159: 4 -15 0 24           // Arg 0 slot 9: [fp + 24] = [fp + -15] + 0
 160: 4 -14 0 25           // Arg 1 slot 0: [fp + 25] = [fp + -14] + 0
 161: 4 -13 0 26           // Arg 1 slot 1: [fp + 26] = [fp + -13] + 0
 162: 4 -12 0 27           // Arg 1 slot 2: [fp + 27] = [fp + -12] + 0
 163: 4 -11 0 28           // Arg 1 slot 3: [fp + 28] = [fp + -11] + 0
 164: 4 -10 0 29           // Arg 1 slot 4: [fp + 29] = [fp + -10] + 0
 165: 4 -9 0 30            // Arg 1 slot 5: [fp + 30] = [fp + -9] + 0
 166: 4 -8 0 31            // Arg 1 slot 6: [fp + 31] = [fp + -8] + 0
 167: 4 -7 0 32            // Arg 1 slot 7: [fp + 32] = [fp + -7] + 0
 168: 4 -6 0 33            // Arg 1 slot 8: [fp + 33] = [fp + -6] + 0
simulate_battle_round:
 169: 4 -5 0 34            // Arg 1 slot 9: [fp + 34] = [fp + -5] + 0
 170: 10 40 109 _          // call perform_combat
 171: 34 38 1 0 7          // [fp + 7] = u32([fp + 38], [fp + 39]) U32Greater u32(1, 0)
 172: 9 1 45 _             // [fp + 45] = 1
 173: 4 7 0 79             // [fp + 79] = [fp + 7] + 0
 174: 1 45 79 7            // [fp + 7] = [fp + 45] op [fp + 79]
 175: 14 7 2 _             // if [fp + 7] != 0 jmp rel simulate_battle_round_1
 176: 12 220 _ _           // jump abs simulate_battle_round_2
simulate_battle_round_1:
 177: 4 -14 0 46           // Arg 0 slot 0: [fp + 46] = [fp + -14] + 0
 178: 4 -13 0 47           // Arg 0 slot 1: [fp + 47] = [fp + -13] + 0
 179: 4 -12 0 48           // Arg 0 slot 2: [fp + 48] = [fp + -12] + 0
 180: 4 -11 0 49           // Arg 0 slot 3: [fp + 49] = [fp + -11] + 0
 181: 4 -10 0 50           // Arg 0 slot 4: [fp + 50] = [fp + -10] + 0
 182: 4 -9 0 51            // Arg 0 slot 5: [fp + 51] = [fp + -9] + 0
 183: 4 -8 0 52            // Arg 0 slot 6: [fp + 52] = [fp + -8] + 0
 184: 4 -7 0 53            // Arg 0 slot 7: [fp + 53] = [fp + -7] + 0
 185: 4 -6 0 54            // Arg 0 slot 8: [fp + 54] = [fp + -6] + 0
 186: 4 -5 0 55            // Arg 0 slot 9: [fp + 55] = [fp + -5] + 0
 187: 4 -24 0 56           // Arg 1 slot 0: [fp + 56] = [fp + -24] + 0
 188: 4 -23 0 57           // Arg 1 slot 1: [fp + 57] = [fp + -23] + 0
 189: 4 -22 0 58           // Arg 1 slot 2: [fp + 58] = [fp + -22] + 0
 190: 4 -21 0 59           // Arg 1 slot 3: [fp + 59] = [fp + -21] + 0
 191: 4 -20 0 60           // Arg 1 slot 4: [fp + 60] = [fp + -20] + 0
 192: 4 -19 0 61           // Arg 1 slot 5: [fp + 61] = [fp + -19] + 0
 193: 4 -18 0 62           // Arg 1 slot 6: [fp + 62] = [fp + -18] + 0
 194: 4 -17 0 63           // Arg 1 slot 7: [fp + 63] = [fp + -17] + 0
 195: 4 -16 0 64           // Arg 1 slot 8: [fp + 64] = [fp + -16] + 0
 196: 4 -15 0 65           // Arg 1 slot 9: [fp + 65] = [fp + -15] + 0
 197: 10 71 109 _          // call perform_combat
 198: 14 38 6 _            // if [fp + 38] != 0 jmp rel simulate_battle_round_4
 199: 12 222 _ _           // jump abs simulate_battle_round_3
simulate_battle_round_2:
 200: 23 1 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(1)
 201: 11 _ _ _             // return
simulate_battle_round_3:
 202: 23 1 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(1)
 203: 11 _ _ _             // return
simulate_battle_round_4:
 204: 14 69 4 _            // if [fp + 69] != 0 jmp rel simulate_battle_round_6
 205: 12 226 _ _           // jump abs simulate_battle_round_5
simulate_battle_round_5:
 206: 23 2 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(2)
 207: 11 _ _ _             // return
simulate_battle_round_6:
 208: 23 0 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(0)
 209: 11 _ _ _             // return
simulate_full_battle:
simulate_full_battle_0:
 210: 23 10 0 0            // [fp + 0], [fp + 1] = u32(10)
 211: 23 20 0 2            // [fp + 2], [fp + 3] = u32(20)
 212: 23 100 0 4           // [fp + 4], [fp + 5] = u32(100)
 213: 23 50 0 6            // [fp + 6], [fp + 7] = u32(50)
 214: 23 5 0 8             // [fp + 8], [fp + 9] = u32(5)
 215: 4 0 0 10             // [fp + 10] = [fp + 0] + 0
 216: 4 1 0 11             // [fp + 11] = [fp + 1] + 0
 217: 4 2 0 12             // [fp + 12] = [fp + 2] + 0
 218: 4 3 0 13             // [fp + 13] = [fp + 3] + 0
 219: 23 15 0 14           // [fp + 14], [fp + 15] = u32(15)
 220: 23 25 0 16           // [fp + 16], [fp + 17] = u32(25)
 221: 23 80 0 18           // [fp + 18], [fp + 19] = u32(80)
 222: 23 30 0 20           // [fp + 20], [fp + 21] = u32(30)
 223: 23 4 0 22            // [fp + 22], [fp + 23] = u32(4)
 224: 4 14 0 24            // [fp + 24] = [fp + 14] + 0
 225: 4 15 0 25            // [fp + 25] = [fp + 15] + 0
 226: 4 16 0 26            // [fp + 26] = [fp + 16] + 0
 227: 4 17 0 27            // [fp + 27] = [fp + 17] + 0
 228: 23 1 0 28            // u32([fp + 28], [fp + 29]) = u32(1)
 229: 23 10 0 30           // u32([fp + 30], [fp + 31]) = u32(10)
simulate_full_battle:
 230: 4 4 0 32             // [fp + 32] = [fp + 4] + 0 (slot 1 of 10)
 231: 4 5 0 33             // [fp + 33] = [fp + 5] + 0 (slot 2 of 10)
 232: 4 6 0 34             // [fp + 34] = [fp + 6] + 0 (slot 3 of 10)
 233: 4 7 0 35             // [fp + 35] = [fp + 7] + 0 (slot 4 of 10)
 234: 4 8 0 36             // [fp + 36] = [fp + 8] + 0 (slot 5 of 10)
 235: 4 9 0 37             // [fp + 37] = [fp + 9] + 0 (slot 6 of 10)
 236: 4 10 0 38            // [fp + 38] = [fp + 10] + 0 (slot 7 of 10)
 237: 4 11 0 39            // [fp + 39] = [fp + 11] + 0 (slot 8 of 10)
 238: 4 12 0 40            // [fp + 40] = [fp + 12] + 0 (slot 9 of 10)
 239: 4 13 0 41            // [fp + 41] = [fp + 13] + 0 (slot 10 of 10)
 240: 19 28 0 0 42         // u32([fp + 42], [fp + 43]) = u32([fp + 28], [fp + 29]) + u32(0, 0)
 241: 4 18 0 44            // [fp + 44] = [fp + 18] + 0 (slot 1 of 10)
 242: 4 19 0 45            // [fp + 45] = [fp + 19] + 0 (slot 2 of 10)
 243: 4 20 0 46            // [fp + 46] = [fp + 20] + 0 (slot 3 of 10)
 244: 4 21 0 47            // [fp + 47] = [fp + 21] + 0 (slot 4 of 10)
 245: 4 22 0 48            // [fp + 48] = [fp + 22] + 0 (slot 5 of 10)
 246: 4 23 0 49            // [fp + 49] = [fp + 23] + 0 (slot 6 of 10)
 247: 4 24 0 50            // [fp + 50] = [fp + 24] + 0 (slot 7 of 10)
 248: 4 25 0 51            // [fp + 51] = [fp + 25] + 0 (slot 8 of 10)
 249: 4 26 0 52            // [fp + 52] = [fp + 26] + 0 (slot 9 of 10)
 250: 4 27 0 53            // [fp + 53] = [fp + 27] + 0 (slot 10 of 10)
simulate_full_battle_1:
 251: 28 30 42 54          // [fp + 54] = u32([fp + 30], [fp + 31]) U32Greater u32([fp + 42], [fp + 43])
 252: 14 54 4 _            // if [fp + 54] != 0 jmp rel simulate_full_battle_3
 253: 12 278 _ _           // jump abs simulate_full_battle_4
simulate_full_battle_2:
 254: 23 0 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(0)
 255: 11 _ _ _             // return
simulate_full_battle_3:
 256: 12 275 _ _           // jump abs simulate_full_battle_2
simulate_full_battle_4:
 257: 4 32 0 113           // Arg 0 slot 0: [fp + 113] = [fp + 32] + 0
 258: 4 33 0 114           // Arg 0 slot 1: [fp + 114] = [fp + 33] + 0
 259: 4 34 0 115           // Arg 0 slot 2: [fp + 115] = [fp + 34] + 0
 260: 4 35 0 116           // Arg 0 slot 3: [fp + 116] = [fp + 35] + 0
 261: 4 36 0 117           // Arg 0 slot 4: [fp + 117] = [fp + 36] + 0
 262: 4 37 0 118           // Arg 0 slot 5: [fp + 118] = [fp + 37] + 0
 263: 4 38 0 119           // Arg 0 slot 6: [fp + 119] = [fp + 38] + 0
 264: 4 39 0 120           // Arg 0 slot 7: [fp + 120] = [fp + 39] + 0
 265: 4 40 0 121           // Arg 0 slot 8: [fp + 121] = [fp + 40] + 0
 266: 4 41 0 122           // Arg 0 slot 9: [fp + 122] = [fp + 41] + 0
 267: 4 44 0 123           // Arg 1 slot 0: [fp + 123] = [fp + 44] + 0
 268: 4 45 0 124           // Arg 1 slot 1: [fp + 124] = [fp + 45] + 0
 269: 4 46 0 125           // Arg 1 slot 2: [fp + 125] = [fp + 46] + 0
 270: 4 47 0 126           // Arg 1 slot 3: [fp + 126] = [fp + 47] + 0
 271: 4 48 0 127           // Arg 1 slot 4: [fp + 127] = [fp + 48] + 0
 272: 4 49 0 128           // Arg 1 slot 5: [fp + 128] = [fp + 49] + 0
 273: 4 50 0 129           // Arg 1 slot 6: [fp + 129] = [fp + 50] + 0
 274: 4 51 0 130           // Arg 1 slot 7: [fp + 130] = [fp + 51] + 0
 275: 4 52 0 131           // Arg 1 slot 8: [fp + 131] = [fp + 52] + 0
 276: 4 53 0 132           // Arg 1 slot 9: [fp + 132] = [fp + 53] + 0
 277: 10 135 169 _         // call simulate_battle_round
 278: 30 133 1 0 137       // [fp + 137] = u32([fp + 133], [fp + 134]) U32Eq u32(1, 0)
 279: 14 137 2 _           // if [fp + 137] != 0 jmp rel simulate_full_battle_5
 280: 12 305 _ _           // jump abs simulate_full_battle_6
simulate_full_battle_5:
 281: 23 1 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(1)
 282: 11 _ _ _             // return
simulate_full_battle_6:
 283: 30 133 2 0 138       // [fp + 138] = u32([fp + 133], [fp + 134]) U32Eq u32(2, 0)
 284: 14 138 2 _           // if [fp + 138] != 0 jmp rel simulate_full_battle_7
 285: 12 311 _ _           // jump abs simulate_full_battle_8
simulate_full_battle_7:
 286: 23 2 0 -4            // Return value 0: [fp -4, fp -4 + 1] = u32(2)
 287: 11 _ _ _             // return
simulate_full_battle_8:
simulate_full_battle_9:
 288: 34 32 11 0 59        // [fp + 59] = u32([fp + 32], [fp + 33]) U32Greater u32(11, 0)
 289: 9 1 139 _            // [fp + 139] = 1
 290: 4 59 0 148           // [fp + 148] = [fp + 59] + 0
 291: 1 139 148 59         // [fp + 59] = [fp + 139] op [fp + 148]
 292: 4 32 0 60            // [fp + 60] = [fp + 32] + 0 (slot 1 of 10)
 293: 4 33 0 61            // [fp + 61] = [fp + 33] + 0 (slot 2 of 10)
 294: 4 34 0 62            // [fp + 62] = [fp + 34] + 0 (slot 3 of 10)
 295: 4 35 0 63            // [fp + 63] = [fp + 35] + 0 (slot 4 of 10)
 296: 4 36 0 64            // [fp + 64] = [fp + 36] + 0 (slot 5 of 10)
 297: 4 37 0 65            // [fp + 65] = [fp + 37] + 0 (slot 6 of 10)
 298: 4 38 0 66            // [fp + 66] = [fp + 38] + 0 (slot 7 of 10)
 299: 4 39 0 67            // [fp + 67] = [fp + 39] + 0 (slot 8 of 10)
 300: 4 40 0 68            // [fp + 68] = [fp + 40] + 0 (slot 9 of 10)
 301: 4 41 0 69            // [fp + 69] = [fp + 41] + 0 (slot 10 of 10)
 302: 14 59 2 _            // if [fp + 59] != 0 jmp rel simulate_full_battle_10
 303: 12 398 _ _           // jump abs simulate_full_battle_14
simulate_full_battle_10:
 304: 19 32 65531 65535 72 // u32([fp + 72], [fp + 73]) = u32([fp + 32], [fp + 33]) U32Sub u32(65531, 65535)
 305: 4 72 0 32            // [fp + 32] = [fp + 72] + 0
 306: 4 73 0 33            // [fp + 33] = [fp + 73] + 0
 307: 4 32 0 60            // [fp + 60] = [fp + 32] + 0 (slot 1 of 10)
 308: 4 33 0 61            // [fp + 61] = [fp + 33] + 0 (slot 2 of 10)
 309: 4 34 0 62            // [fp + 62] = [fp + 34] + 0 (slot 3 of 10)
 310: 4 35 0 63            // [fp + 63] = [fp + 35] + 0 (slot 4 of 10)
 311: 4 36 0 64            // [fp + 64] = [fp + 36] + 0 (slot 5 of 10)
 312: 4 37 0 65            // [fp + 65] = [fp + 37] + 0 (slot 6 of 10)
 313: 4 38 0 66            // [fp + 66] = [fp + 38] + 0 (slot 7 of 10)
 314: 4 39 0 67            // [fp + 67] = [fp + 39] + 0 (slot 8 of 10)
 315: 4 40 0 68            // [fp + 68] = [fp + 40] + 0 (slot 9 of 10)
 316: 4 41 0 69            // [fp + 69] = [fp + 41] + 0 (slot 10 of 10)
simulate_full_battle_11:
 317: 34 44 9 0 86         // [fp + 86] = u32([fp + 44], [fp + 45]) U32Greater u32(9, 0)
 318: 9 1 140 _            // [fp + 140] = 1
 319: 4 86 0 148           // [fp + 148] = [fp + 86] + 0
 320: 1 140 148 86         // [fp + 86] = [fp + 140] op [fp + 148]
 321: 4 44 0 87            // [fp + 87] = [fp + 44] + 0 (slot 1 of 10)
 322: 4 45 0 88            // [fp + 88] = [fp + 45] + 0 (slot 2 of 10)
 323: 4 46 0 89            // [fp + 89] = [fp + 46] + 0 (slot 3 of 10)
 324: 4 47 0 90            // [fp + 90] = [fp + 47] + 0 (slot 4 of 10)
 325: 4 48 0 91            // [fp + 91] = [fp + 48] + 0 (slot 5 of 10)
 326: 4 49 0 92            // [fp + 92] = [fp + 49] + 0 (slot 6 of 10)
 327: 4 50 0 93            // [fp + 93] = [fp + 50] + 0 (slot 7 of 10)
 328: 4 51 0 94            // [fp + 94] = [fp + 51] + 0 (slot 8 of 10)
 329: 4 52 0 95            // [fp + 95] = [fp + 52] + 0 (slot 9 of 10)
 330: 4 53 0 96            // [fp + 96] = [fp + 53] + 0 (slot 10 of 10)
 331: 14 86 2 _            // if [fp + 86] != 0 jmp rel simulate_full_battle_12
 332: 12 399 _ _           // jump abs simulate_full_battle_15
simulate_full_battle_12:
 333: 19 44 65532 65535 99 // u32([fp + 99], [fp + 100]) = u32([fp + 44], [fp + 45]) U32Sub u32(65532, 65535)
 334: 4 99 0 44            // [fp + 44] = [fp + 99] + 0
 335: 4 100 0 45           // [fp + 45] = [fp + 100] + 0
 336: 4 44 0 87            // [fp + 87] = [fp + 44] + 0 (slot 1 of 10)
 337: 4 45 0 88            // [fp + 88] = [fp + 45] + 0 (slot 2 of 10)
 338: 4 46 0 89            // [fp + 89] = [fp + 46] + 0 (slot 3 of 10)
 339: 4 47 0 90            // [fp + 90] = [fp + 47] + 0 (slot 4 of 10)
 340: 4 48 0 91            // [fp + 91] = [fp + 48] + 0 (slot 5 of 10)
 341: 4 49 0 92            // [fp + 92] = [fp + 49] + 0 (slot 6 of 10)
 342: 4 50 0 93            // [fp + 93] = [fp + 50] + 0 (slot 7 of 10)
 343: 4 51 0 94            // [fp + 94] = [fp + 51] + 0 (slot 8 of 10)
 344: 4 52 0 95            // [fp + 95] = [fp + 52] + 0 (slot 9 of 10)
 345: 4 53 0 96            // [fp + 96] = [fp + 53] + 0 (slot 10 of 10)
simulate_full_battle_13:
 346: 19 42 1 0 111        // u32([fp + 111], [fp + 112]) = u32([fp + 42], [fp + 43]) U32Add u32(1, 0)
 347: 4 60 0 32            // [fp + 32] = [fp + 60] + 0 (slot 1 of 10)
 348: 4 61 0 33            // [fp + 33] = [fp + 61] + 0 (slot 2 of 10)
 349: 4 62 0 34            // [fp + 34] = [fp + 62] + 0 (slot 3 of 10)
 350: 4 63 0 35            // [fp + 35] = [fp + 63] + 0 (slot 4 of 10)
 351: 4 64 0 36            // [fp + 36] = [fp + 64] + 0 (slot 5 of 10)
 352: 4 65 0 37            // [fp + 37] = [fp + 65] + 0 (slot 6 of 10)
 353: 4 66 0 38            // [fp + 38] = [fp + 66] + 0 (slot 7 of 10)
 354: 4 67 0 39            // [fp + 39] = [fp + 67] + 0 (slot 8 of 10)
 355: 4 68 0 40            // [fp + 40] = [fp + 68] + 0 (slot 9 of 10)
 356: 4 69 0 41            // [fp + 41] = [fp + 69] + 0 (slot 10 of 10)
 357: 19 111 0 0 42        // u32([fp + 42], [fp + 43]) = u32([fp + 111], [fp + 112]) + u32(0, 0)
 358: 4 87 0 44            // [fp + 44] = [fp + 87] + 0 (slot 1 of 10)
 359: 4 88 0 45            // [fp + 45] = [fp + 88] + 0 (slot 2 of 10)
 360: 4 89 0 46            // [fp + 46] = [fp + 89] + 0 (slot 3 of 10)
 361: 4 90 0 47            // [fp + 47] = [fp + 90] + 0 (slot 4 of 10)
 362: 4 91 0 48            // [fp + 48] = [fp + 91] + 0 (slot 5 of 10)
 363: 4 92 0 49            // [fp + 49] = [fp + 92] + 0 (slot 6 of 10)
 364: 4 93 0 50            // [fp + 50] = [fp + 93] + 0 (slot 7 of 10)
 365: 4 94 0 51            // [fp + 51] = [fp + 94] + 0 (slot 8 of 10)
 366: 4 95 0 52            // [fp + 52] = [fp + 95] + 0 (slot 9 of 10)
 367: 4 96 0 53            // [fp + 53] = [fp + 96] + 0 (slot 10 of 10)
 368: 12 272 _ _           // jump abs simulate_full_battle_1
simulate_full_battle_14:
 369: 12 342 _ _           // jump abs simulate_full_battle_11
simulate_full_battle_15:
 370: 12 373 _ _           // jump abs simulate_full_battle_13
