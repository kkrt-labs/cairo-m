---
source: crates/compiler/semantic/src/validation/tests/mod.rs
expression: snapshot_content
---
Fixture: assignment_validation.cm
============================================================
Source code:
// Test cases for assignment validation

struct Point {
    x: felt,
    y: felt,
}

func assignment_validation() {
    // Valid assignments
    let a: felt = 1;
    a = 2;                        // OK: same type
    a = 1 + 2;                    // OK: arithmetic result
    a = 1 && 2;                   // OK: logical result

    let b: Point = Point { x: 1, y: 2 };
    b = Point { x: 3, y: 4 };     // OK: same type
    b = Point { x: 1 + 2, y: 3 + 4 }; // OK: complex initialization

    // Invalid assignments
    a = Point { x: 1, y: 2 };     // Error: type mismatch
    a = (1, 2);                   // Error: type mismatch
    b = 42;                       // Error: type mismatch

    // Field assignments
    let c: Point = Point { x: 1, y: 2 };
    c.x = 3;                      // OK: felt to felt
    c.y = 4;                      // OK: felt to felt
    c.x = Point { x: 1, y: 2 };   // Error: type mismatch

    // Invalid assignment targets
    42 = 1;                       // Error: invalid target
    (1, 2) = 1;                   // Error: invalid target

    return 0;
} 

============================================================
Found 6 diagnostic(s):

--- Diagnostic 1 ---
[2001] Error: Type mismatch in assignment. Cannot assign 'Point' to 'felt'
    ╭─[ <unknown>:20:9 ]
    │
 20 │     a = Point { x: 1, y: 2 };     // Error: type mismatch
    │         ──────────┬─────────  
    │                   ╰─────────── Type mismatch in assignment. Cannot assign 'Point' to 'felt'
────╯

--- Diagnostic 2 ---
[2001] Error: Type mismatch in assignment. Cannot assign '(felt, felt)' to 'felt'
    ╭─[ <unknown>:21:9 ]
    │
 21 │     a = (1, 2);                   // Error: type mismatch
    │         ───┬──  
    │            ╰──── Type mismatch in assignment. Cannot assign '(felt, felt)' to 'felt'
────╯

--- Diagnostic 3 ---
[2001] Error: Type mismatch in assignment. Cannot assign 'felt' to 'Point'
    ╭─[ <unknown>:22:9 ]
    │
 22 │     b = 42;                       // Error: type mismatch
    │         ─┬  
    │          ╰── Type mismatch in assignment. Cannot assign 'felt' to 'Point'
────╯

--- Diagnostic 4 ---
[2001] Error: Type mismatch in assignment. Cannot assign 'Point' to 'felt'
    ╭─[ <unknown>:28:11 ]
    │
 28 │     c.x = Point { x: 1, y: 2 };   // Error: type mismatch
    │           ──────────┬─────────  
    │                     ╰─────────── Type mismatch in assignment. Cannot assign 'Point' to 'felt'
────╯

--- Diagnostic 5 ---
[2010] Error: Invalid assignment target - must be a variable, field, or array element
    ╭─[ <unknown>:31:5 ]
    │
 31 │     42 = 1;                       // Error: invalid target
    │     ─┬  
    │      ╰── Invalid assignment target - must be a variable, field, or array element
────╯

--- Diagnostic 6 ---
[2010] Error: Invalid assignment target - must be a variable, field, or array element
    ╭─[ <unknown>:32:5 ]
    │
 32 │     (1, 2) = 1;                   // Error: invalid target
    │     ───┬──  
    │        ╰──── Invalid assignment target - must be a variable, field, or array element
────╯
