---
source: crates/compiler/semantic/src/validation/tests/mod.rs
expression: snapshot_content
---
Fixture: unreachable_code.cm
============================================================
Source code:
func test_unreachable_after_return() -> felt {
    return 42;
    let x = 5;  // unreachable
    let y = 10; // unreachable
}

func test_nested_blocks() -> felt {
    {
        return 1;
        let y = 2;  // unreachable
    }
}

func test_if_statements() -> felt {
    if (1 == 1) {
        return 100;
        let z = 3;  // unreachable
    }
    let after_if = 4;  // reachable
    return after_if;
}

func test_if_else_both_terminate() -> felt {
    if (1 == 1) {
        return 100;
    } else {
        return 200;
    }
    let unreachable_after_if_else = 5;  // unreachable - both branches return
    return();
}

func test_if_else_only_then_terminates() -> felt {
    if (1 == 1) {
        return 100;
    } else {
        let x = 1;  // reachable
    }
    let reachable_after_if = 6;  // reachable - else doesn't return
    return reachable_after_if;
    return();
}

func test_nested_if_else() -> felt {
    if (1 == 1) {
        if (2 == 2) {
            return 300;
        } else {
            return 400;
        }
        let unreachable_in_outer_if = 7;  // unreachable - inner if-else both return
    } else {
        return 500;
    }
    let unreachable_after_outer_if = 8;  // unreachable - all branches return
    return();
}

func test_clean_function() -> felt {
    let a = 1;
    let b = 2;
    return a + b;
}

func test_multiple_returns() -> felt {
    let x = 1;
    if (x == 1) {
        return x;
    }
    return 0;  // reachable (else case)
}

============================================================
Found 21 diagnostic(s):

--- Diagnostic 1 ---
[1002] Warning: Unused variable 'x'
   ╭─[ unreachable_code.cm:3:9 ]
   │
 3 │     let x = 5;  // unreachable
   │         ┬  
   │         ╰── Unused variable 'x'
───╯

--- Diagnostic 2 ---
[1002] Warning: Unused variable 'y'
   ╭─[ unreachable_code.cm:4:9 ]
   │
 4 │     let y = 10; // unreachable
   │         ┬  
   │         ╰── Unused variable 'y'
───╯

--- Diagnostic 3 ---
[1002] Warning: Unused variable 'y'
    ╭─[ unreachable_code.cm:10:13 ]
    │
 10 │         let y = 2;  // unreachable
    │             ┬  
    │             ╰── Unused variable 'y'
────╯

--- Diagnostic 4 ---
[1002] Warning: Unused variable 'z'
    ╭─[ unreachable_code.cm:17:13 ]
    │
 17 │         let z = 3;  // unreachable
    │             ┬  
    │             ╰── Unused variable 'z'
────╯

--- Diagnostic 5 ---
[1002] Warning: Unused variable 'unreachable_after_if_else'
    ╭─[ unreachable_code.cm:29:9 ]
    │
 29 │     let unreachable_after_if_else = 5;  // unreachable - both branches return
    │         ────────────┬────────────  
    │                     ╰────────────── Unused variable 'unreachable_after_if_else'
────╯

--- Diagnostic 6 ---
[1002] Warning: Unused variable 'x'
    ╭─[ unreachable_code.cm:37:13 ]
    │
 37 │         let x = 1;  // reachable
    │             ┬  
    │             ╰── Unused variable 'x'
────╯

--- Diagnostic 7 ---
[1002] Warning: Unused variable 'unreachable_after_outer_if'
    ╭─[ unreachable_code.cm:55:9 ]
    │
 55 │     let unreachable_after_outer_if = 8;  // unreachable - all branches return
    │         ─────────────┬────────────  
    │                      ╰────────────── Unused variable 'unreachable_after_outer_if'
────╯

--- Diagnostic 8 ---
[1002] Warning: Unused variable 'unreachable_in_outer_if'
    ╭─[ unreachable_code.cm:51:13 ]
    │
 51 │         let unreachable_in_outer_if = 7;  // unreachable - inner if-else both return
    │             ───────────┬───────────  
    │                        ╰───────────── Unused variable 'unreachable_in_outer_if'
────╯

--- Diagnostic 9 ---
[2001] Error: Type mismatch in return statement. Expected 'felt', found '()'
    ╭─[ unreachable_code.cm:30:5 ]
    │
 30 │     return();
    │     ────┬────  
    │         ╰────── Type mismatch in return statement. Expected 'felt', found '()'
────╯

--- Diagnostic 10 ---
[2001] Error: Type mismatch in return statement. Expected 'felt', found '()'
    ╭─[ unreachable_code.cm:41:5 ]
    │
 41 │     return();
    │     ────┬────  
    │         ╰────── Type mismatch in return statement. Expected 'felt', found '()'
────╯

--- Diagnostic 11 ---
[2001] Error: Type mismatch in return statement. Expected 'felt', found '()'
    ╭─[ unreachable_code.cm:56:5 ]
    │
 56 │     return();
    │     ────┬────  
    │         ╰────── Type mismatch in return statement. Expected 'felt', found '()'
────╯

--- Diagnostic 12 ---
[3001] Warning: Unreachable variable declaration
   ╭─[ unreachable_code.cm:3:5 ]
   │
 3 │     let x = 5;  // unreachable
   │     ─────┬────  
   │          ╰────── Unreachable variable declaration
───╯

--- Diagnostic 13 ---
[3001] Warning: Unreachable variable declaration
   ╭─[ unreachable_code.cm:4:5 ]
   │
 4 │     let y = 10; // unreachable
   │     ─────┬─────  
   │          ╰─────── Unreachable variable declaration
───╯

--- Diagnostic 14 ---
[3001] Warning: Unreachable variable declaration
    ╭─[ unreachable_code.cm:10:9 ]
    │
 10 │         let y = 2;  // unreachable
    │         ─────┬────  
    │              ╰────── Unreachable variable declaration
────╯

--- Diagnostic 15 ---
[3001] Warning: Unreachable variable declaration
    ╭─[ unreachable_code.cm:17:9 ]
    │
 17 │         let z = 3;  // unreachable
    │         ─────┬────  
    │              ╰────── Unreachable variable declaration
────╯

--- Diagnostic 16 ---
[3001] Warning: Unreachable variable declaration
    ╭─[ unreachable_code.cm:29:5 ]
    │
 29 │     let unreachable_after_if_else = 5;  // unreachable - both branches return
    │     ─────────────────┬────────────────  
    │                      ╰────────────────── Unreachable variable declaration
────╯

--- Diagnostic 17 ---
[3001] Warning: Unreachable return statement
    ╭─[ unreachable_code.cm:30:5 ]
    │
 30 │     return();
    │     ────┬────  
    │         ╰────── Unreachable return statement
────╯

--- Diagnostic 18 ---
[3001] Warning: Unreachable return statement
    ╭─[ unreachable_code.cm:41:5 ]
    │
 41 │     return();
    │     ────┬────  
    │         ╰────── Unreachable return statement
────╯

--- Diagnostic 19 ---
[3001] Warning: Unreachable variable declaration
    ╭─[ unreachable_code.cm:51:9 ]
    │
 51 │         let unreachable_in_outer_if = 7;  // unreachable - inner if-else both return
    │         ────────────────┬───────────────  
    │                         ╰───────────────── Unreachable variable declaration
────╯

--- Diagnostic 20 ---
[3001] Warning: Unreachable variable declaration
    ╭─[ unreachable_code.cm:55:5 ]
    │
 55 │     let unreachable_after_outer_if = 8;  // unreachable - all branches return
    │     ─────────────────┬─────────────────  
    │                      ╰─────────────────── Unreachable variable declaration
────╯

--- Diagnostic 21 ---
[3001] Warning: Unreachable return statement
    ╭─[ unreachable_code.cm:56:5 ]
    │
 56 │     return();
    │     ────┬────  
    │         ╰────── Unreachable return statement
────╯
