---
source: crates/compiler/semantic/src/validation/tests/mod.rs
expression: snapshot_content
---
Fixture: return_type_validation.cm
============================================================
Source code:
// Test cases for return type validation

struct Point {
    x: felt,
    y: felt,
}

// Valid return type functions
func valid_return_felt() -> felt {
    return 42;                    // OK: correct return type
}

func valid_return_point() -> Point {
    return Point { x: 1, y: 2 };  // OK: correct return type
}

func valid_return_conditional() -> felt {
    if (1) {
        return 1;                 // OK: correct return type
    } else {
        return 2;                 // OK: correct return type
    }
}

// Invalid return type functions
func invalid_return_felt() -> felt {
    return Point { x: 1, y: 2 };  // Error: wrong return type
}

func invalid_return_point() -> Point {
    return 42;                    // Error: wrong return type
}

func invalid_return_conditional() -> felt {
    if (1) {
        return Point { x: 1, y: 2 }; // Error: wrong return type
    } else {
        return 42;                 // Ok: correct return type
    }
}

// Missing return value
func missing_return() -> felt {
    // Error: no return statement
} 

============================================================
Found 4 diagnostic(s):

--- Diagnostic 1 ---
[2001] Error: Type mismatch in return statement. Expected 'felt', found 'Point'
    ╭─[ <unknown>:27:5 ]
    │
 27 │     return Point { x: 1, y: 2 };  // Error: wrong return type
    │     ──────────────┬─────────────  
    │                   ╰─────────────── Type mismatch in return statement. Expected 'felt', found 'Point'
────╯

--- Diagnostic 2 ---
[2001] Error: Type mismatch in return statement. Expected 'Point', found 'felt'
    ╭─[ <unknown>:31:5 ]
    │
 31 │     return 42;                    // Error: wrong return type
    │     ─────┬────  
    │          ╰────── Type mismatch in return statement. Expected 'Point', found 'felt'
────╯

--- Diagnostic 3 ---
[2001] Error: Type mismatch in return statement. Expected 'felt', found 'Point'
    ╭─[ <unknown>:36:9 ]
    │
 36 │         return Point { x: 1, y: 2 }; // Error: wrong return type
    │         ──────────────┬─────────────  
    │                       ╰─────────────── Type mismatch in return statement. Expected 'felt', found 'Point'
────╯

--- Diagnostic 4 ---
[3002] Error: Function 'missing_return' doesn't return on all paths
    ╭─[ <unknown>:43:6 ]
    │
 43 │ func missing_return() -> felt {
    │      ───────┬──────  
    │             ╰──────── Function 'missing_return' doesn't return on all paths
────╯
